#!/bin/bash

MODE="$1"   # empty | edit

SCREENSHOT_DIR="$HOME/Pictures/Screenshots"
mkdir -p "$SCREENSHOT_DIR"

FILE="screenshot_$(date +%Y%m%d_%H%M%S).png"
FULL="$SCREENSHOT_DIR/$FILE"

GEOMETRY=$(slurp)
[ -z "$GEOMETRY" ] && notify-send -u low "Screenshot cancelled" && exit 0

grim -g "$GEOMETRY" "$FULL" || exit 1

case "$MODE" in
  edit)
    swappy -f "$FULL" -o "$FULL"
    wl-copy < "$FULL"
    notify-send -i "$FULL" "Screenshot edited" "$FULL"
    ;;
  *)
    wl-copy < "$FULL"
    notify-send -i "$FULL" "Screenshot saved" "$FULL"
    ;;
esac
